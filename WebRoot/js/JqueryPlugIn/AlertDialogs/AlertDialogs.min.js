(function($){$.alerts={verticalOffset:-75,horizontalOffset:0,repositionOnResize:true,overlayOpacity:.01,overlayColor:'#FFF',draggable:true,okButton:'确定',cancelButton:'取消',dialogClass:null,alert:function(message,title,callback,p_AutoCloseTime){if(title==null)title='提示！';$.alerts._show(title,message,null,'alert',function(result){if(callback)callback(result)},p_AutoCloseTime)},confirm:function(message,title,callback){if(title==null)title='确认！';$.alerts._show(title,message,null,'confirm',function(result){if(callback)callback(result)})},prompt:function(message,value,title,callback){if(title==null)title='输入！';$.alerts._show(title,message,value,'prompt',function(result){if(callback)callback(result)})},_show:function(title,msg,value,type,callback,p_AutoCloseTime){$.alerts._hide();$.alerts._overlay('show');$("BODY").append('<div id="popup_container">'+'<h1 id="popup_title"></h1>'+'<div id="popup_content">'+'<div id="popup_message"></div>'+'</div>'+'</div>');if($.alerts.dialogClass)$("#popup_container").addClass($.alerts.dialogClass);$("#popup_container").css({position:'fixed',zIndex:99999,padding:0,margin:0});$("#popup_title").text(title);$("#popup_content").addClass(type);$("#popup_message").text(msg);$("#popup_message").html($("#popup_message").text().replace(/\n/g,'<br />'));$("#popup_container").css({minWidth:$("#popup_container").outerWidth(),maxWidth:$("#popup_container").outerWidth()});$.alerts._reposition();$.alerts._maintainPosition(true);switch(type){case'alert':$("#popup_message").after('<div id="popup_panel"><input type="button" value="'+$.alerts.okButton+'" id="popup_ok" /></div>');var _AutoCloseTimeID;var _TimeoutID;if(p_AutoCloseTime!=null){_AutoCloseTimeID=setTimeout(function(){$("#popup_ok").trigger('click')},p_AutoCloseTime)}var _popup_okObject=jQuery("#popup_ok");_popup_okObject.click(function(){$.alerts._hide();clearTimeout(_TimeoutID);clearTimeout(_AutoCloseTimeID);callback(true)}).keydown(function(e){if(e.keyCode==13||e.keyCode==27){e.preventDefault();_popup_okObject.trigger('click')}}).blur(function(){if(_popup_okObject.is(":visible")){clearTimeout(_TimeoutID);_TimeoutID=setTimeout(function(){_popup_okObject.focus()},1)}});setTimeout(function(){_popup_okObject.focus()},1);break;case'confirm':$("#popup_message").after('<div id="popup_panel"><input type="button" value="'+$.alerts.okButton+'" id="popup_ok" />        <input type="button" value="'+$.alerts.cancelButton+'" id="popup_cancel" /></div>');var _popup_okObject=jQuery("#popup_ok");var _popup_cancelObject=jQuery("#popup_cancel");_popup_okObject.click(function(){$.alerts._hide();if(callback)callback(true)}).keydown(function(e){if(e.keyCode==13){e.preventDefault();_popup_okObject.trigger('click')}if(e.keyCode==27){_popup_cancelObject.trigger('click')}if(e.keyCode==39){_popup_cancelObject.focus()}});_popup_cancelObject.click(function(){$.alerts._hide();if(callback)callback(false)}).keydown(function(e){if(e.keyCode==13||e.keyCode==27){e.preventDefault();_popup_cancelObject.trigger('click')}if(e.keyCode==37){_popup_okObject.focus()}}).focus();break;case'prompt':$("#popup_message").append('<br /><input type="text" size="30" id="popup_prompt" />').after('<div id="popup_panel"><input type="button" value="'+$.alerts.okButton+'" id="popup_ok" /> <input type="button" value="'+$.alerts.cancelButton+'" id="popup_cancel" /></div>');$("#popup_prompt").width($("#popup_message").width());$("#popup_ok").click(function(){var val=$("#popup_prompt").val();$.alerts._hide();if(callback)callback(val)}).keydown(function(e){if(e.keyCode==39){$("#popup_cancel").focus()}});$("#popup_cancel").click(function(){$.alerts._hide();if(callback)callback(null)}).keydown(function(e){if(e.keyCode==13||e.keyCode==27){e.preventDefault();$("#popup_cancel").trigger('click')}if(e.keyCode==37){$("#popup_ok").focus()}});$("#popup_prompt, #popup_ok").keydown(function(e){if(e.keyCode==13){e.preventDefault();$("#popup_ok").trigger('click')}if(e.keyCode==27){$("#popup_cancel").trigger('click')}});if(value)$("#popup_prompt").val(value);$("#popup_prompt").focus().select();break};if($.alerts.draggable){try{$("#popup_container").draggable({handle:$("#popup_title")});$("#popup_title").css({cursor:'move'})}catch(e){}}},_hide:function(){$("#popup_container").remove();$.alerts._overlay('hide');$.alerts._maintainPosition(false)},_overlay:function(status){switch(status){case'show':$.alerts._overlay('hide');$("BODY").append('<div id="popup_overlay"></div>');$("#popup_overlay").css({position:'absolute',zIndex:99998,top:'0px',left:'0px',width:'100%',height:$(document).height(),background:$.alerts.overlayColor,opacity:$.alerts.overlayOpacity});break;case'hide':$("#popup_overlay").remove();break}},_reposition:function(){var top=(($(window).height()/2)-($("#popup_container").outerHeight()/2))+$.alerts.verticalOffset;var left=(($(window).width()/2)-($("#popup_container").outerWidth()/2))+$.alerts.horizontalOffset;if(top<0)top=0;if(left<0)left=0;$("#popup_container").css({top:top+'px',left:left+'px'});$("#popup_overlay").height($(document).height())},_maintainPosition:function(status){if($.alerts.repositionOnResize){switch(status){case true:$(window).bind('resize',$.alerts._reposition);break;case false:$(window).unbind('resize',$.alerts._reposition);break}}}};jAlert=function(message,title,callback,p_AutoCloseTime){$.alerts.alert(message,title,callback,p_AutoCloseTime)};jAlertDialogs=function(p_Message,p_FocusID,p_AutoCloseTime){jAlert(p_Message,null,function(r){if(p_FocusID!=null){jQuery("#"+p_FocusID).focus()}},p_AutoCloseTime)};jConfirm=function(message,title,callback){$.alerts.confirm(message,title,callback)};jPrompt=function(message,value,title,callback){$.alerts.prompt(message,value,title,callback)}})(jQuery);